<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–µ—Å—Ç –∑–∞–≥—Ä—É–∑–∫–∏ –ø–æ–∑–∏—Ü–∏–∏ –ª–æ–≤—É—à–∫–∏ –∏–∑ –ë–î</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f0f0f0;
        }
        
        .container {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        
        .status {
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
        }
        
        .success { background-color: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
        .error { background-color: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }
        .info { background-color: #cce7ff; color: #004085; border: 1px solid #b3d7ff; }
        .warning { background-color: #fff3cd; color: #856404; border: 1px solid #ffeaa7; }
        
        button {
            background-color: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
            font-size: 14px;
        }
        
        button:hover {
            background-color: #0056b3;
        }
        
        button:disabled {
            background-color: #6c757d;
            cursor: not-allowed;
        }
        
        .log {
            background-color: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 5px;
            padding: 15px;
            max-height: 300px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
            font-size: 12px;
        }
        
        .control-panel {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 10px;
            margin-bottom: 20px;
        }
        
        select, input {
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
        }
        
        .coefficient-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 10px;
            margin: 10px 0;
        }
        
        .coeff-box {
            padding: 10px;
            background-color: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 5px;
            text-align: center;
        }
        
        .coeff-box.current {
            background-color: #fff3cd;
            border-color: #ffeaa7;
        }
    </style>
</head>
<body>
    <h1>üéØ –¢–µ—Å—Ç –∑–∞–≥—Ä—É–∑–∫–∏ –ø–æ–∑–∏—Ü–∏–∏ –ª–æ–≤—É—à–∫–∏ –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö</h1>
    
    <div class="container">
        <h2>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞–º–∏</h2>
        <div class="control-panel">
            <div>
                <label>–£—Ä–æ–≤–µ–Ω—å —Å–ª–æ–∂–Ω–æ—Å—Ç–∏:</label>
                <select id="difficulty">
                    <option value="easy">Easy</option>
                    <option value="medium">Medium</option>
                    <option value="hard">Hard</option>
                    <option value="hardcore">Hardcore</option>
                </select>
            </div>
            <div>
                <label>–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç:</label>
                <input type="number" id="coefficient" step="0.01" placeholder="–í–≤–µ–¥–∏—Ç–µ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç">
            </div>
            <div>
                <label>User ID:</label>
                <input type="text" id="userId" value="demo" placeholder="demo –∏–ª–∏ user_id">
            </div>
        </div>
        
        <div>
            <button onclick="setCoefficient()">üìù –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç</button>
            <button onclick="getCoefficient()">üìÑ –ü–æ–ª—É—á–∏—Ç—å –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç</button>
            <button onclick="simulateGameStart()">üéÆ –°–∏–º—É–ª–∏—Ä–æ–≤–∞—Ç—å –Ω–∞–∂–∞—Ç–∏–µ Play</button>
            <button onclick="clearLog()">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å –ª–æ–≥</button>
        </div>
    </div>
    
    <div class="container">
        <h2>–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞—Ö</h2>
        <div id="coefficientInfo" class="coefficient-info">
            <!-- –ó–¥–µ—Å—å –±—É–¥–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞—Ö -->
        </div>
    </div>
    
    <div class="container">
        <h2>–õ–æ–≥ –æ–ø–µ—Ä–∞—Ü–∏–π</h2>
        <div id="log" class="log">
            <div class="info">–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é...</div>
        </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
        // –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã –ø–æ —É—Ä–æ–≤–Ω—è–º —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ (–∫–æ–ø–∏—è –∏–∑ game2.js)
        const CFS = {
            easy: [ 1.03, 1.07, 1.12, 1.17, 1.23, 1.29, 1.36, 1.44, 1.53, 1.63, 1.75, 1.88, 2.04, 2.22, 2.45, 2.72, 3.06, 3.50, 4.08, 4.90, 6.13, 6.61, 9.81, 19.44 ], 
            medium: [ 1.12, 1.28, 1.47, 1.70, 1.98, 2.33, 2.76, 3.32, 4.03, 4.96, 6.20, 6.91, 8.90, 11.74, 15.99, 22.61, 33.58, 53.20, 92.17, 182.51, 451.71, 1788.80 ],  
            hard: [ 1.23, 1.55, 1.98, 2.56, 3.36, 4.49, 5.49, 7.53, 10.56, 15.21, 22.59, 34.79, 55.97, 94.99, 172.42, 341.40, 760.46, 2007.63, 6956.47, 41321.43 ], 
            hardcore: [ 1.63, 2.80, 4.95, 9.08, 15.21, 30.12, 62.96, 140.24, 337.19, 890.19, 2643.89, 9161.08, 39301.05, 233448.29 ]
        };
        
        function addLog(message, type = 'info') {
            const log = document.getElementById('log');
            const timestamp = new Date().toLocaleTimeString();
            const logEntry = `<div class="${type}">[${timestamp}] ${message}</div>`;
            log.innerHTML += logEntry;
            log.scrollTop = log.scrollHeight;
        }
        
        function clearLog() {
            document.getElementById('log').innerHTML = '<div class="info">–õ–æ–≥ –æ—á–∏—â–µ–Ω...</div>';
        }
        
        function updateCoefficientInfo() {
            const difficulty = document.getElementById('difficulty').value;
            const coefficients = CFS[difficulty];
            const infoDiv = document.getElementById('coefficientInfo');
            
            let html = `<div class="coeff-box"><strong>–£—Ä–æ–≤–µ–Ω—å:</strong><br>${difficulty.toUpperCase()}</div>`;
            html += `<div class="coeff-box"><strong>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ:</strong><br>${coefficients.length}</div>`;
            html += `<div class="coeff-box"><strong>–ú–∏–Ω –∫–æ—ç—Ñ—Ñ:</strong><br>${Math.min(...coefficients)}</div>`;
            html += `<div class="coeff-box"><strong>–ú–∞–∫—Å –∫–æ—ç—Ñ—Ñ:</strong><br>${Math.max(...coefficients)}</div>`;
            
            infoDiv.innerHTML = html;
        }
        
        function setCoefficient() {
            const difficulty = document.getElementById('difficulty').value;
            const coefficient = parseFloat(document.getElementById('coefficient').value);
            const userId = document.getElementById('userId').value || 'demo';
            const isDemo = userId === 'demo' ? 1 : 0;
            
            if (!coefficient || coefficient <= 0) {
                addLog('‚ùå –û—à–∏–±–∫–∞: –≤–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç', 'error');
                return;
            }
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —Ç–∞–∫–æ–π –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –≤ –≤—ã–±—Ä–∞–Ω–Ω–æ–º —É—Ä–æ–≤–Ω–µ
            const coefficients = CFS[difficulty];
            const coeffIndex = coefficients.findIndex(coeff => Math.abs(coeff - coefficient) < 0.01);
            
            if (coeffIndex === -1) {
                addLog(`‚ö†Ô∏è –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ: –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç ${coefficient} –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ —É—Ä–æ–≤–Ω–µ ${difficulty}`, 'warning');
            } else {
                addLog(`‚úÖ –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç ${coefficient} –Ω–∞–π–¥–µ–Ω –≤ –ø–æ–∑–∏—Ü–∏–∏ ${coeffIndex} –¥–ª—è —É—Ä–æ–≤–Ω—è ${difficulty}`, 'success');
            }
            
            $.ajax({
                url: "/hack/pe/db-chicken-api.php",
                type: "json",
                method: "post",
                data: { 
                    action: "update_chicken_coefficient",
                    coefficient: coefficient,
                    user_id: userId,
                    is_demo: isDemo,
                    difficulty_level: difficulty,
                    coefficient_index: coeffIndex,
                    test_mode: true
                },
                error: function(e) { 
                    addLog(`‚ùå –û—à–∏–±–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞: ${e.statusText}`, 'error');
                },
                success: function(r) {
                    const obj = typeof r == "string" ? JSON.parse(r) : r;
                    if (obj.success) {
                        addLog(`‚úÖ –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç ${coefficient} —É—Å–ø–µ—à–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –¥–ª—è ${userId} (${isDemo ? '–¥–µ–º–æ' : '—Ä–µ–∞–ª—å–Ω—ã–π'} —Ä–µ–∂–∏–º)`, 'success');
                    } else {
                        addLog(`‚ùå –û—à–∏–±–∫–∞: ${obj.message}`, 'error');
                    }
                }
            });
        }
        
        function getCoefficient() {
            const userId = document.getElementById('userId').value || 'demo';
            const isDemo = userId === 'demo' ? 1 : 0;
            
            $.ajax({
                url: "/hack/pe/db-chicken-api.php",
                type: "json",
                method: "post",
                data: { 
                    action: "get_chicken_coefficient",
                    user_id: userId,
                    is_demo: isDemo
                },
                error: function(e) { 
                    addLog(`‚ùå –û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞: ${e.statusText}`, 'error');
                },
                success: function(r) {
                    const obj = typeof r == "string" ? JSON.parse(r) : r;
                    if (obj.success) {
                        const difficulty = document.getElementById('difficulty').value;
                        const coefficients = CFS[difficulty];
                        const coeffIndex = coefficients.findIndex(coeff => Math.abs(coeff - obj.coefficient) < 0.01);
                        
                        addLog(`üìÑ –¢–µ–∫—É—â–∏–π –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –¥–ª—è ${userId}: ${obj.coefficient}`, 'info');
                        
                        if (coeffIndex !== -1) {
                            addLog(`üéØ –ü–æ–∑–∏—Ü–∏—è –ª–æ–≤—É—à–∫–∏ –≤ —É—Ä–æ–≤–Ω–µ ${difficulty}: ${coeffIndex} (–∫–æ—ç—Ñ—Ñ: ${coefficients[coeffIndex]})`, 'success');
                        } else {
                            addLog(`‚ö†Ô∏è –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç ${obj.coefficient} –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ —Ç–µ–∫—É—â–µ–º —É—Ä–æ–≤–Ω–µ ${difficulty}`, 'warning');
                        }
                    } else {
                        addLog(`‚ùå –û—à–∏–±–∫–∞: ${obj.message}`, 'error');
                    }
                }
            });
        }
        
        function simulateGameStart() {
            const difficulty = document.getElementById('difficulty').value;
            const userId = document.getElementById('userId').value || 'demo';
            const isDemo = userId === 'demo' ? 1 : 0;
            
            addLog(`üéÆ –°–∏–º—É–ª—è—Ü–∏—è –Ω–∞–∂–∞—Ç–∏—è –∫–Ω–æ–ø–∫–∏ Play –¥–ª—è ${userId} (—É—Ä–æ–≤–µ–Ω—å: ${difficulty})`, 'info');
            
            // –°–Ω–∞—á–∞–ª–∞ –ø–æ–ª—É—á–∞–µ–º –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –∏–∑ –ë–î
            $.ajax({
                url: "/hack/pe/db-chicken-api.php",
                type: "json",
                method: "post",
                data: { 
                    action: "get_chicken_coefficient",
                    user_id: userId,
                    is_demo: isDemo
                },
                error: function(e) { 
                    addLog(`‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø–æ–∑–∏—Ü–∏–∏ –ª–æ–≤—É—à–∫–∏: ${e.statusText}`, 'error');
                    addLog(`üé≤ –ë—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∞ —Å–ª—É—á–∞–π–Ω–∞—è –ø–æ–∑–∏—Ü–∏—è –ª–æ–≤—É—à–∫–∏`, 'warning');
                },
                success: function(r) {
                    const obj = typeof r == "string" ? JSON.parse(r) : r;
                    if (obj.success && obj.coefficient) {
                        // –ù–∞—Ö–æ–¥–∏–º –ø–æ–∑–∏—Ü–∏—é –ª–æ–≤—É—à–∫–∏ –ø–æ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—É
                        const coefficients = CFS[difficulty];
                        const coeffIndex = coefficients.findIndex(coeff => Math.abs(coeff - obj.coefficient) < 0.01);
                        
                        if (coeffIndex !== -1) {
                            addLog(`‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω–∞ –ø–æ–∑–∏—Ü–∏—è –ª–æ–≤—É—à–∫–∏ –∏–∑ –ë–î: –ø–æ–∑–∏—Ü–∏—è ${coeffIndex}, –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç ${obj.coefficient}`, 'success');
                            addLog(`üèÅ –ò–≥—Ä–∞ –±—É–¥–µ—Ç –Ω–∞—á–∞—Ç–∞ —Å –ª–æ–≤—É—à–∫–æ–π –Ω–∞ –ø–æ–∑–∏—Ü–∏–∏ ${coeffIndex}`, 'success');
                        } else {
                            addLog(`‚ö†Ô∏è –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç ${obj.coefficient} –∏–∑ –ë–î –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ —É—Ä–æ–≤–Ω–µ ${difficulty}`, 'warning');
                            addLog(`üé≤ –ë—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∞ —Å–ª—É—á–∞–π–Ω–∞—è –ø–æ–∑–∏—Ü–∏—è –ª–æ–≤—É—à–∫–∏`, 'warning');
                        }
                    } else {
                        addLog(`‚ö†Ô∏è –ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –ø–æ–∑–∏—Ü–∏—é –ª–æ–≤—É—à–∫–∏ –∏–∑ –ë–î: ${obj.message || '–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞'}`, 'warning');
                        addLog(`üé≤ –ë—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∞ —Å–ª—É—á–∞–π–Ω–∞—è –ø–æ–∑–∏—Ü–∏—è –ª–æ–≤—É—à–∫–∏`, 'warning');
                    }
                    
                    // –ü–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏/–æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø–æ–∑–∏—Ü–∏–∏ –ª–æ–≤—É—à–∫–∏ - —Å–∏–º—É–ª–∏—Ä—É–µ–º –∑–∞–ø—É—Å–∫ –∏–≥—Ä—ã
                    addLog(`üöÄ –ò–≥—Ä–∞ –∑–∞–ø—É—â–µ–Ω–∞! (–ª–æ–≥–∏–∫–∞ game2.js –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—É—é –ø–æ–∑–∏—Ü–∏—é)`, 'info');
                }
            });
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        document.addEventListener('DOMContentLoaded', function() {
            updateCoefficientInfo();
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –ø—Ä–∏ —Å–º–µ–Ω–µ —É—Ä–æ–≤–Ω—è —Å–ª–æ–∂–Ω–æ—Å—Ç–∏
            document.getElementById('difficulty').addEventListener('change', updateCoefficientInfo);
            
            addLog('üéØ –°–∏—Å—Ç–µ–º–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ –ø–æ–∑–∏—Ü–∏–∏ –ª–æ–≤—É—à–∫–∏ –≥–æ—Ç–æ–≤–∞', 'success');
            addLog('üí° –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è:', 'info');
            addLog('1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –¥–ª—è –Ω—É–∂–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è', 'info');
            addLog('2. –ù–∞–∂–º–∏—Ç–µ "–°–∏–º—É–ª–∏—Ä–æ–≤–∞—Ç—å –Ω–∞–∂–∞—Ç–∏–µ Play" —á—Ç–æ–±—ã –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∑–∞–≥—Ä—É–∑–∫—É', 'info');
            addLog('3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Å–∏—Å—Ç–µ–º–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∑–∞–≥—Ä—É–∂–∞–µ—Ç –ø–æ–∑–∏—Ü–∏—é –ª–æ–≤—É—à–∫–∏ –∏–∑ –ë–î', 'info');
        });
    </script>
</body>
</html>

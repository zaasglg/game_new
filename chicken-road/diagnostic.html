<!DOCTYPE html>
<html>
<head>
    <title>Chicken Road - –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        body { 
            font-family: Arial, sans-serif; 
            margin: 20px; 
            background: #2c3e50; 
            color: white; 
        }
        .diagnostic { 
            background: #34495e; 
            padding: 20px; 
            margin: 10px 0; 
            border-radius: 5px; 
        }
        .error { background: #e74c3c; }
        .success { background: #27ae60; }
        .warning { background: #f39c12; }
        button {
            background: #3498db;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover { background: #2980b9; }
        #game-area {
            background: #34495e;
            min-height: 300px;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            text-align: center;
        }
        .road {
            background: #444;
            height: 80px;
            margin: 20px 0;
            position: relative;
            border-radius: 5px;
        }
        .chicken {
            position: absolute;
            left: 20px;
            top: 20px;
            font-size: 30px;
            transition: left 0.3s ease;
        }
    </style>
</head>
<body>
    <h1>üêî Chicken Road - –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞</h1>
    
    <div class="diagnostic">
        <h3>–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π:</h3>
        <div id="status">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
    </div>

    <div class="diagnostic">
        <h3>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:</h3>
        <button onclick="testAPI()">–¢–µ—Å—Ç API</button>
        <button onclick="testDatabase()">–¢–µ—Å—Ç –ë–î</button>
        <button onclick="startSimpleGame()">–ü—Ä–æ—Å—Ç–∞—è –∏–≥—Ä–∞</button>
        <button onclick="resetGame()">–°–±—Ä–æ—Å</button>
    </div>

    <div id="game-area">
        <h2>–ò–≥—Ä–æ–≤–∞—è –∑–æ–Ω–∞</h2>
        <div class="road">
            <div class="chicken" id="chicken">üêî</div>
        </div>
        <div id="game-status">–ù–∞–∂–º–∏—Ç–µ "–ü—Ä–æ—Å—Ç–∞—è –∏–≥—Ä–∞" –¥–ª—è —Å—Ç–∞—Ä—Ç–∞</div>
        <div>
            <label>–°—Ç–∞–≤–∫–∞: </label>
            <input type="number" id="bet-input" value="10" min="1" max="1000">
            <button onclick="placeBet()">–°–¥–µ–ª–∞—Ç—å —Å—Ç–∞–≤–∫—É</button>
        </div>
    </div>

    <div class="diagnostic">
        <h3>–õ–æ–≥–∏:</h3>
        <div id="logs" style="max-height: 200px; overflow-y: auto; background: #2c3e50; padding: 10px; border-radius: 5px;"></div>
    </div>

    <script>
        let gameActive = false;
        let balance = 1000;
        
        function log(message, type = 'info') {
            const logs = document.getElementById('logs');
            const time = new Date().toLocaleTimeString();
            const logEntry = `<div class="${type}">[${time}] ${message}</div>`;
            logs.innerHTML += logEntry;
            logs.scrollTop = logs.scrollHeight;
            console.log(`[${type}] ${message}`);
        }

        function updateStatus(message, type = 'info') {
            const status = document.getElementById('status');
            status.innerHTML = `<span class="${type}">${message}</span>`;
            log(`Status: ${message}`, type);
        }

        async function testAPI() {
            log('–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ API...', 'info');
            try {
                const response = await fetch('/chicken-road/test_api.php');
                const data = await response.json();
                
                if (data.success) {
                    log('‚úÖ API —Ä–∞–±–æ—Ç–∞–µ—Ç! –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã –∑–∞–≥—Ä—É–∂–µ–Ω—ã', 'success');
                    log(`–î–∞–Ω–Ω—ã–µ: ${JSON.stringify(data.data)}`, 'info');
                    updateStatus('API –ø–æ–¥–∫–ª—é—á–µ–Ω', 'success');
                } else {
                    log(`‚ùå –û—à–∏–±–∫–∞ API: ${data.message}`, 'error');
                    updateStatus('–û—à–∏–±–∫–∞ API', 'error');
                }
            } catch (error) {
                log(`‚ùå –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ API: ${error.message}`, 'error');
                updateStatus('API –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω', 'error');
            }
        }

        async function testDatabase() {
            log('–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö...', 'info');
            try {
                const response = await fetch('/chicken-road/test_api.php');
                const data = await response.json();
                
                if (data.success && data.data) {
                    const coeffCount = Object.values(data.data).reduce((acc, arr) => acc + arr.length, 0);
                    log(`‚úÖ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Ä–∞–±–æ—Ç–∞–µ—Ç! –ù–∞–π–¥–µ–Ω–æ ${coeffCount} –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤`, 'success');
                    updateStatus('–ë–î –ø–æ–¥–∫–ª—é—á–µ–Ω–∞', 'success');
                } else {
                    log('‚ùå –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –ø—É—Å—Ç–∞ –∏–ª–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞', 'error');
                    updateStatus('–û—à–∏–±–∫–∞ –ë–î', 'error');
                }
            } catch (error) {
                log(`‚ùå –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î: ${error.message}`, 'error');
                updateStatus('–ë–î –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞', 'error');
            }
        }

        function startSimpleGame() {
            if (gameActive) {
                log('‚ö†Ô∏è –ò–≥—Ä–∞ —É–∂–µ –∞–∫—Ç–∏–≤–Ω–∞', 'warning');
                return;
            }
            
            gameActive = true;
            log('üéÆ –ò–≥—Ä–∞ –∑–∞–ø—É—â–µ–Ω–∞! –ù–∞–∂–º–∏—Ç–µ –ø—Ä–æ–±–µ–ª –¥–ª—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏', 'success');
            document.getElementById('game-status').textContent = '–ò–≥—Ä–∞ –∞–∫—Ç–∏–≤–Ω–∞! –ù–∞–∂–º–∏—Ç–µ –ü–†–û–ë–ï–õ';
            
            // –ü—Ä–æ—Å—Ç–∞—è –∞–Ω–∏–º–∞—Ü–∏—è –∫—É—Ä–∏—Ü—ã
            const chicken = document.getElementById('chicken');
            let position = 20;
            
            const moveChicken = () => {
                if (!gameActive) return;
                
                position += 2;
                if (position > 300) position = 20;
                
                chicken.style.left = position + 'px';
                requestAnimationFrame(moveChicken);
            };
            
            moveChicken();
        }

        function stopGame() {
            if (!gameActive) return;
            
            gameActive = false;
            const multiplier = (Math.random() * 3 + 0.5).toFixed(2);
            const bet = parseInt(document.getElementById('bet-input').value) || 10;
            const win = (bet * multiplier).toFixed(2);
            
            balance += parseFloat(win) - bet;
            
            log(`üéØ –ò–≥—Ä–∞ –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞! –ú–Ω–æ–∂–∏—Ç–µ–ª—å: ${multiplier}x, –í—ã–∏–≥—Ä—ã—à: ${win}`, 'success');
            document.getElementById('game-status').textContent = `–ú–Ω–æ–∂–∏—Ç–µ–ª—å: ${multiplier}x | –ë–∞–ª–∞–Ω—Å: ${balance.toFixed(2)}`;
        }

        function placeBet() {
            const bet = parseInt(document.getElementById('bet-input').value) || 10;
            if (bet > balance) {
                log('‚ùå –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤!', 'error');
                return;
            }
            
            log(`üí∞ –°—Ç–∞–≤–∫–∞ ${bet} –ø—Ä–∏–Ω—è—Ç–∞`, 'info');
            if (!gameActive) {
                startSimpleGame();
            }
        }

        function resetGame() {
            gameActive = false;
            balance = 1000;
            document.getElementById('chicken').style.left = '20px';
            document.getElementById('game-status').textContent = '–ò–≥—Ä–∞ —Å–±—Ä–æ—à–µ–Ω–∞';
            log('üîÑ –ò–≥—Ä–∞ —Å–±—Ä–æ—à–µ–Ω–∞', 'info');
        }

        // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–ª–∞–≤–∏–∞—Ç—É—Ä–æ–π
        document.addEventListener('keydown', (e) => {
            if (e.code === 'Space' && gameActive) {
                e.preventDefault();
                stopGame();
            }
        });

        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        window.onload = () => {
            log('üöÄ –°—Ç—Ä–∞–Ω–∏—Ü–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞, –Ω–∞—á–∏–Ω–∞–µ–º –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É...', 'info');
            setTimeout(testAPI, 500);
            setTimeout(testDatabase, 1000);
        };
    </script>
</body>
</html>
